<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Plotting trait data</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Plotting trait data</h1>



<div style="text-align: justify">
<p>Many packages exist to visualize trait data for biological species.
<strong>deeptime</strong> similarly has a few novel ways to help you
plot your data in useful ways. We’ll first load some packages and
example data so we can demonstrate some of this functionality.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># Load deeptime</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(deeptime)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co"># Load other packages</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co"># Load dispRity for example data</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="fu">library</span>(dispRity)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="fu">data</span>(demo_data)</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co"># Load paleotree for example data</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="fu">library</span>(phytools)</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="fu">data</span>(mammal.tree)</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="fu">data</span>(mammal.data)</span></code></pre></div>
<div id="plot-disparity-through-time" class="section level2">
<h2>Plot disparity through time</h2>
<p>A common way to visualize trait data, especially for fossil species,
is to show the two-dimensional trait distribution for several time
intervals. This allows the viewer to easily compare the trait
distribution through time. However, producing such a plot has
historically been very time intensive, often involving the use of custom
code and image editing software (e.g., <a href="https://inkscape.org/">Inkscape</a>). While a single function to
accomplish such a visualization still does not exist for
<code>{ggplot2}</code> (yet…), the <code>coord_trans_xy()</code>
function can be used to generate a similar plot with sheared trait space
across several time intervals.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># make transformer</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>trans <span class="ot">&lt;-</span> <span class="fu">linear_trans</span>(<span class="fu">shear</span>(.<span class="dv">75</span>, <span class="dv">0</span>))</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co"># prepare data to be plotted</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>crinoids <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(demo_data<span class="sc">$</span>wright<span class="sc">$</span>matrix[[<span class="dv">1</span>]][, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>crinoids<span class="sc">$</span>time <span class="ot">&lt;-</span> <span class="st">&quot;before extinction&quot;</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>crinoids<span class="sc">$</span>time[demo_data<span class="sc">$</span>wright<span class="sc">$</span>subsets<span class="sc">$</span>after<span class="sc">$</span>elements] <span class="ot">&lt;-</span> <span class="st">&quot;after extinction&quot;</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co"># a box to outline the trait space</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>square <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">V1 =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">6</span>, <span class="sc">-</span>.<span class="dv">6</span>, .<span class="dv">6</span>, .<span class="dv">6</span>), <span class="at">V2 =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">4</span>, .<span class="dv">4</span>, .<span class="dv">4</span>, <span class="sc">-</span>.<span class="dv">4</span>))</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>      <span class="at">x =</span> <span class="sc">-</span>.<span class="dv">6</span>, <span class="at">y =</span> <span class="fu">seq</span>(<span class="sc">-</span>.<span class="dv">4</span>, .<span class="dv">4</span>, .<span class="dv">2</span>),</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>      <span class="at">xend =</span> .<span class="dv">6</span>, <span class="at">yend =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.4</span>, .<span class="dv">4</span>, .<span class="dv">2</span>)</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>    ),</span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend),</span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span>.<span class="dv">6</span>, .<span class="dv">6</span>, .<span class="dv">2</span>), <span class="at">y =</span> <span class="sc">-</span>.<span class="dv">4</span>,</span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a>      <span class="at">xend =</span> <span class="fu">seq</span>(<span class="sc">-</span>.<span class="dv">6</span>, .<span class="dv">6</span>, .<span class="dv">2</span>), <span class="at">yend =</span> .<span class="dv">4</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a>    ),</span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend),</span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> square, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2), <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> crinoids, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a>  <span class="fu">coord_trans_xy</span>(<span class="at">trans =</span> trans, <span class="at">expand =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;PCO1&quot;</span>, <span class="at">y =</span> <span class="st">&quot;PCO2&quot;</span>) <span class="sc">+</span></span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>time, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">strip.position =</span> <span class="st">&quot;right&quot;</span>) <span class="sc">+</span></span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;lines&quot;</span>), <span class="at">panel.background =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div id="disparity-in-base-r" class="section level3">
<h3>Disparity in base R</h3>
<p>The <code>disparity_through_time()</code> function accomplishes
nearly all of the work for you if you are comfortable plotting within
the <code>{lattice}</code> framework (base R). Note that it may take
some tweaking (especially the <code>aspect</code> argument) to get the
results to look the way you want.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>crinoids<span class="sc">$</span>time <span class="ot">&lt;-</span> <span class="fu">factor</span>(crinoids<span class="sc">$</span>time)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">disparity_through_time</span>(time <span class="sc">~</span> V2 <span class="sc">*</span> V1,</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="at">data =</span> crinoids, <span class="at">groups =</span> time, <span class="at">aspect =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, .<span class="dv">6</span>),</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">6</span>, .<span class="dv">6</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">5</span>, .<span class="dv">5</span>),</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  <span class="at">col.regions =</span> <span class="st">&quot;lightyellow&quot;</span>, <span class="at">col.point =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  <span class="at">par.settings =</span> <span class="fu">list</span>(</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">list</span>(<span class="at">col =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>    <span class="at">layout.heights =</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>        <span class="at">top.padding =</span> <span class="sc">-</span><span class="dv">20</span>, <span class="at">main.key.padding =</span> <span class="dv">0</span>,</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>        <span class="at">key.axis.padding =</span> <span class="dv">0</span>, <span class="at">axis.xlab.padding =</span> <span class="dv">0</span>,</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>        <span class="at">xlab.key.padding =</span> <span class="dv">0</span>, <span class="at">key.sub.padding =</span> <span class="dv">0</span>,</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>        <span class="at">bottom.padding =</span> <span class="sc">-</span><span class="dv">20</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>      ),</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>    <span class="at">layout.widths =</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>        <span class="at">left.padding =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">key.ylab.padding =</span> <span class="dv">0</span>,</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>        <span class="at">ylab.axis.padding =</span> <span class="dv">0</span>, <span class="at">axis.key.padding =</span> <span class="dv">0</span>,</span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>        <span class="at">right.padding =</span> <span class="dv">0</span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>      )</span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>  )</span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="phylomorphospaces" class="section level2">
<h2>Phylomorphospaces</h2>
<p>Often, trait data will be accompanied with a phylogeny. You may want
to visualize both your phylogeny, the traits of your species, and the
evolution of the trait along your phylogeny. To accomplish this, you can
create a two-dimensional phylomorphospace. The <code>{phytools}</code>
package has the <code>phytools::phylomorphospace()</code> function for
accomplishing this in base R. The <code>geom_phylomorpho()</code>
function in <strong>deeptime</strong> will help you accomplish this with
<code>ggplot()</code>. Note that labels can be added using
<code>geom_label()</code> or <code>ggrepel::geom_label_repel()</code>,
but they are not demonstrated here because they would obscure the
phylogenetic relationships.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>mammal.data<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">rownames</span>(mammal.data)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="fu">ggplot</span>(mammal.data, <span class="fu">aes</span>(<span class="at">x =</span> bodyMass, <span class="at">y =</span> homeRange, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="fu">geom_phylomorpho</span>(mammal.tree) <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
